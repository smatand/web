---
import Base from "../layouts/Base.astro";
import matter from "gray-matter";
import fs from "node:fs";

const raw = fs.readFileSync("src/content/pages/about.md", "utf-8");
const { data } = matter(raw);

const profile: string = data.profile ?? "";
const experience: { company: string; role: string; location: string; duration: string; description: string }[] = data.experience ?? [];
const education: { school: string; faculty?: string; degree: string; location: string; duration: string; thesis?: string }[] = data.education ?? [];
const projects: { name: string; url: string; description: string; lang: string }[] = data.projects ?? [];
const languages: string[] = data.languages ?? [];
const spoken: string[] = data.spoken ?? [];
const interests: string[] = data.interests ?? [];

// DESIGN OPTION: Change this to switch themes
// Options: "modern-clean", "retro-cyber", "minimal-cards", "gradient-bold"
const designTheme = "modern-clean";
---

<Base title="About / CV">
  <style define:vars={{ designTheme }}>
    /* ═══ DESIGN 1: MODERN CLEAN (default) ═══ */
    .about-container[data-design="modern-clean"] {
      padding: 0;
    }

    .about-container[data-design="modern-clean"] .profile-section {
      background: linear-gradient(135deg, #000000 0%, #000000 100%);
      border-bottom: 2px solid #ff8c00;
      padding: 20px 0;
      margin: -24px -28px 24px;
    }

    .about-container[data-design="modern-clean"] .profile-text {
      font-size: 13px;
      line-height: 1.8;
      color: #ccc;
      margin-bottom: 0;
    }

    .about-container[data-design="modern-clean"] .info-box {
      background: #000000;
      border: 1px solid #333;
      border-left: 3px solid #ff8c00;
      padding: 16px;
    }

    .about-container[data-design="modern-clean"] .timeline-item::before {
      background: #ff8c00;
      border: 2px solid #222233;
    }

    /* ═══ DESIGN 2: RETRO CYBER ═══ */
    .about-container[data-design="retro-cyber"] .profile-section {
      background: #111;
      border: 2px solid #ff8c00;
      border-style: dashed;
      padding: 16px 0;
      margin: -24px -28px 24px;
      box-shadow: 0 0 10px rgba(233, 69, 96, 0.3);
    }

    .about-container[data-design="retro-cyber"] .profile-text {
      font-size: 12px;
      font-family: 'Courier New', monospace;
      color: #7ec8e3;
      margin-bottom: 0;
      letter-spacing: 0.5px;
    }

    .about-container[data-design="retro-cyber"] .info-box {
      background: #000000;
      border: 2px dashed #7ec8e3;
      padding: 14px;
      box-shadow: inset 0 0 5px rgba(126, 200, 227, 0.1);
    }

    .about-container[data-design="retro-cyber"] .info-box h3 {
      color: #7ec8e3;
      text-shadow: 0 0 5px rgba(126, 200, 227, 0.5);
    }

    .about-container[data-design="retro-cyber"] .lang-badge {
      background: #000000;
      border: 1px solid #ff8c00;
      color: #ff8c00;
      font-family: 'Courier New', monospace;
      font-weight: bold;
      box-shadow: 0 0 3px rgba(255, 140, 0, 0.3);
    }

    .about-container[data-design="retro-cyber"] .timeline-item::before {
      background: #7ec8e3;
      box-shadow: 0 0 8px rgba(126, 200, 227, 0.6);
    }

    .about-container[data-design="retro-cyber"] .project-card {
      background: #000000;
      border: 2px dashed #7ec8e3;
      box-shadow: inset 0 0 5px rgba(126, 200, 227, 0.1);
      transition: all 0.25s ease;
    }

    .about-container[data-design="retro-cyber"] .project-card:hover {
      box-shadow: 0 0 15px rgba(46, 204, 113, 0.4), inset 0 0 5px rgba(46, 204, 113, 0.1);
      border-color: #ff8c00;
    }

    /* ═══ DESIGN 3: MINIMAL CARDS ═══ */
    .about-container[data-design="minimal-cards"] .profile-section {
      background: transparent;
      border-bottom: 1px solid #333;
      padding: 12px 0 20px;
      margin: -24px -28px 24px;
    }

    .about-container[data-design="minimal-cards"] .profile-text {
      font-size: 13px;
      line-height: 1.8;
      color: #bbb;
      margin-bottom: 0;
    }

    .about-container[data-design="minimal-cards"] .info-box {
      background: transparent;
      border: none;
      border-top: 2px solid #ff8c00;
      padding: 12px 0;
      border-left: none;
    }

    .about-container[data-design="minimal-cards"] .info-box h3 {
      border-bottom: none;
      padding-bottom: 4px;
      margin-bottom: 10px;
    }

    .about-container[data-design="minimal-cards"] .lang-badge {
      background: transparent;
      border: 1px solid #ff8c00;
      padding: 6px 12px;
      color: #ff8c00;
      font-weight: bold;
    }

    .about-container[data-design="minimal-cards"] .timeline-item::before {
      width: 10px;
      height: 10px;
      background: #ff8c00;
    }

    .about-container[data-design="minimal-cards"] .timeline-desc {
      display: none;
    }

    .about-container[data-design="minimal-cards"] .project-card {
      background: #000000;
      border: 1px solid #333;
      border-left: 3px solid #ff8c00;
      padding: 12px;
    }

    /* ═══ DESIGN 4: GRADIENT BOLD ═══ */
    .about-container[data-design="gradient-bold"] .profile-section {
      background: linear-gradient(135deg, #ff8c00 0%, #c23150 100%);
      padding: 24px 0;
      margin: -24px -28px 24px;
      border: none;
    }

    .about-container[data-design="gradient-bold"] .profile-text {
      font-size: 13px;
      line-height: 1.8;
      color: #fff;
      margin-bottom: 0;
      font-weight: 500;
    }

    .about-container[data-design="gradient-bold"] .info-box {
      background: linear-gradient(135deg, #000000 0%, #000000 100%);
      border: 2px solid #ff8c00;
      border-left: 2px solid #ff8c00;
      padding: 16px;
    }

    .about-container[data-design="gradient-bold"] .info-box h3 {
      color: #ff8c00;
      border-bottom: 2px solid #ff8c00;
      text-transform: uppercase;
      font-weight: bold;
    }

    .about-container[data-design="gradient-bold"] .lang-badge {
      background: linear-gradient(135deg, #ff8c00 0%, #ff6347 100%);
      border: none;
      color: #fff;
      font-weight: bold;
    }

    .about-container[data-design="gradient-bold"] .interest-tag {
      background: linear-gradient(135deg, #000000 0%, #000000 100%);
      border: 2px solid #7ec8e3;
      color: #7ec8e3;
    }

    .about-container[data-design="gradient-bold"] .interest-tag.primary {
      background: linear-gradient(135deg, #ff8c00 0%, #c23150 100%);
      border: none;
      color: #fff;
    }

    .about-container[data-design="gradient-bold"] .timeline-item::before {
      background: linear-gradient(135deg, #ff8c00 0%, #7ec8e3 100%);
      width: 12px;
      height: 12px;
    }

    .about-container[data-design="gradient-bold"] .project-card {
      background: linear-gradient(135deg, #000000 0%, #000000 100%);
      border: 2px solid #ff8c00;
      transition: all 0.25s ease;
    }

    .about-container[data-design="gradient-bold"] .project-card:hover {
      box-shadow: 0 0 20px rgba(46, 204, 113, 0.3);
      transform: translateY(-2px);
    }

    /* ═══ SHARED STYLES ═══ */
    .about-container {
      padding: 0;
      user-select: none;
    }

    /* Allow text selection on all elements */
    .about-container {
      user-select: auto;
    }

    .about-container a {
      user-select: auto;
      cursor: pointer;
    }

    .profile-inner {
      padding: 0 28px;
    }

    .about-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-bottom: 24px;
    }

    .info-box h3 {
      font-size: 12px;
      text-transform: uppercase;
      letter-spacing: 1px;
      color: #ff8c00;
      border-bottom: 1px solid #333;
      padding-bottom: 8px;
      margin-bottom: 12px;
      margin-top: 0;
    }

    .info-box p {
      margin: 6px 0;
      font-size: 12px;
    }

    .lang-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
      gap: 6px;
      margin-top: 8px;
    }

    .lang-badge {
      background: #000000;
      border: 1px solid #ff8c00;
      color: #ff8c00;
      padding: 6px 12px;
      font-size: 12px;
      font-weight: bold;
      text-align: center;
      border-radius: 0;
    }

    .timeline-section {
      margin-bottom: 32px;
    }

    .timeline-item {
      display: flex;
      gap: 16px;
      margin-bottom: 20px;
      position: relative;
      padding-left: 20px;
    }

    .timeline-item::before {
      content: "";
      position: absolute;
      left: 0;
      top: 6px;
      width: 8px;
      height: 8px;
      background: #ff8c00;
      border: 2px solid #222233;
    }

    .timeline-content {
      flex: 1;
    }

    .timeline-title {
      font-weight: bold;
      color: #e0e0e0;
      font-size: 15px;
      margin-bottom: 3px;
    }

    .timeline-meta {
      color: #7ec8e3;
      font-size: 13px;
      margin-bottom: 3px;
    }

    .timeline-date {
      color: #ff8c00;
      font-size: 12px;
      font-weight: bold;
      margin-bottom: 6px;
    }

    .timeline-desc {
      color: #999;
      font-size: 13px;
      line-height: 1.65;
    }

    .timeline-thesis {
      color: #888;
      font-size: 12px;
      font-style: italic;
      margin-top: 6px;
    }

    .projects-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 12px;
      margin-top: 12px;
    }

    .project-card {
      background: #000000;
      border: 1px solid #333;
      padding: 12px;
      display: flex;
      flex-direction: column;
      cursor: pointer;
      transition: all 0.25s ease;
    }

    .project-card:hover {
      border-color: #ff8c00;
      background: #000000;
      box-shadow: 0 0 12px rgba(46, 204, 113, 0.2);
    }

    .project-card-title {
      font-weight: bold;
      color: #7ec8e3;
      font-size: 13px;
      margin-bottom: 6px;
    }

    .project-card-title a {
      color: #7ec8e3;
      text-decoration: none;
    }

    .project-card-title a:hover {
      text-decoration: underline;
    }

    .project-card-desc {
      color: #999;
      font-size: 12px;
      margin-bottom: 8px;
      flex: 1;
    }

    .project-card-lang {
      color: #ff8c00;
      font-size: 11px;
      font-weight: bold;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .interest-tags {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-top: 8px;
    }

    .interest-tag {
      background: #000000;
      border: 1px solid #ff8c00;
      color: #ff8c00;
      padding: 6px 12px;
      font-size: 12px;
      font-weight: bold;
      border-radius: 0;
    }

    .interest-tag.primary {
      border-color: #ff8c00;
      color: #ff8c00;
    }

    .section-divider {
      height: 1px;
      background: linear-gradient(90deg, transparent, #333, transparent);
      margin: 32px 0;
    }

    /* Light mode overrides for about page */
    body.light-mode .about-container[data-design="modern-clean"] .profile-section {
      background: linear-gradient(135deg, #e0e0e0 0%, #e0e0e0 100%);
    }

    body.light-mode .about-container[data-design="modern-clean"] .profile-text {
      color: #333;
    }

    body.light-mode .about-container[data-design="modern-clean"] .info-box {
      background: #e0e0e0;
      border: 1px solid #ccc;
      border-left: 3px solid #ff8c00;
    }

    body.light-mode .about-container[data-design="modern-clean"] .info-box h3 {
      color: #ff8c00;
      border-bottom: 1px solid #ccc;
    }

    body.light-mode .project-card,
    body.light-mode .lang-badge,
    body.light-mode .interest-tag {
      background: #e0e0e0;
      border-color: #ccc;
    }

    body.light-mode .project-card {
      border: 1px solid #ccc;
    }

    body.light-mode .lang-badge {
      border: 1px solid #ccc;
      color: #555;
    }

    body.light-mode .interest-tag {
      border: 1px solid #ccc;
      color: #555;
    }

    body.light-mode .project-card-title,
    body.light-mode .project-card-title a {
      color: #333;
    }

    body.light-mode .project-card-desc {
      color: #666;
    }

    body.light-mode .project-card-lang {
      color: #ff8c00;
    }

    body.light-mode .section-divider {
      background: linear-gradient(90deg, transparent, #ccc, transparent);
    }

    /* Dark mode h2 styling - orange bars under headers */
    .about-container h2 {
      border-bottom: 2px solid #ff8c00;
    }

    body.light-mode .about-container h2 {
      color: #222;
      border-bottom: 2px solid #ff8c00;
    }

    body.light-mode .timeline-title {
      color: #222;
    }

    body.light-mode .timeline-meta {
      color: #555;
    }

    body.light-mode .timeline-desc {
      color: #666;
    }

    @media (max-width: 700px) {
      .about-grid {
        grid-template-columns: 1fr;
      }

      .projects-grid {
        grid-template-columns: 1fr;
      }

      .profile-section {
        margin-left: -24px;
        margin-right: -24px;
        padding-left: 24px;
        padding-right: 24px;
      }

      .profile-inner {
        padding: 0;
      }
    }
  </style>

  <div class="about-container" data-design={designTheme}>
    {profile && (
      <div class="profile-section">
        <div class="profile-inner">
          <p class="profile-text">{profile}</p>
        </div>
      </div>
    )}

    <!-- Experience Section -->
    <h2>Work Experience</h2>
    <div class="timeline-section">
      {experience.map((exp) => (
        <div class="timeline-item">
          <div class="timeline-content">
            <div class="timeline-title">{exp.role}</div>
            <div class="timeline-meta">{exp.company} · {exp.location}</div>
            <div class="timeline-date">{exp.duration}</div>
            <div class="timeline-desc">{exp.description}</div>
          </div>
        </div>
      ))}
    </div>

    <!-- Education Section -->
    <div class="section-divider"></div>
    <h2>Education</h2>
    <div class="timeline-section">
      {education.map((edu) => (
        <div class="timeline-item">
          <div class="timeline-content">
            <div class="timeline-title">{edu.degree}</div>
            <div class="timeline-meta">{edu.faculty ? `${edu.faculty}, ` : ""}{edu.school}</div>
            <div class="timeline-date">{edu.duration} · {edu.location}</div>
            {edu.thesis && <div class="timeline-thesis">Thesis: {edu.thesis}</div>}
          </div>
        </div>
      ))}
    </div>

    <!-- Projects Section -->
    <div class="section-divider"></div>
    <h2>Personal Projects</h2>
    <div class="projects-grid">
      {projects.map((proj) => (
        <div class="project-card">
          <div class="project-card-title">
            <a href={proj.url} target="_blank">{proj.name}</a>
          </div>
          <div class="project-card-desc">{proj.description}</div>
          <div class="project-card-lang">{proj.lang}</div>
        </div>
      ))}
    </div>

    <!-- Languages and Interests at Bottom -->
    <div class="section-divider"></div>
    <div class="about-grid">
      <div class="info-box">
        <h3>Programming Languages</h3>
        <div class="lang-grid">
          {languages.map((lang) => (
            <div class="lang-badge">{lang}</div>
          ))}
        </div>
      </div>

      <div class="info-box">
        <h3>Interests</h3>
        <div class="interest-tags">
          {interests.map((i) => (
            <span class="interest-tag primary">{i}</span>
          ))}
        </div>
      </div>
    </div>
  </div>

  <script>
    // Make entire project cards clickable
    document.querySelectorAll('.project-card').forEach(card => {
      const link = card.querySelector('a');
      if (link) {
        card.style.cursor = 'pointer';
        card.addEventListener('click', () => {
          window.open(link.href, '_blank');
        });
      }
    });
  </script>
</Base>
