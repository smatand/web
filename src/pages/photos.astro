---
import Base from "../layouts/Base.astro";
import { getCollection } from "astro:content";
import { Image } from "astro:assets";

const photos = (await getCollection("photos")).sort(
  (a, b) => b.data.date.getTime() - a.data.date.getTime(),
);
---

<Base title="Photos">
  <h2>Analog Photography</h2>
  <p>Shots from my film camera. Captured on analog, scanned for the web.</p>

  {photos.length === 0 && (
    <p><em>No photos yet â€” upload some via the <a href="/admin/">CMS admin panel</a>.</em></p>
  )}

  {photos.length > 0 && (
    <div class="gallery">
      {photos.map((photo) => (
        <div class="photo-card">
          <Image src={photo.data.image} alt={photo.data.caption ?? photo.data.title} width={400} />
          <div class="photo-info">
            {photo.data.caption ?? photo.data.title}
            <br />
            {photo.data.date.toLocaleDateString()}
          </div>
        </div>
      ))}
    </div>
  )}
</Base>
